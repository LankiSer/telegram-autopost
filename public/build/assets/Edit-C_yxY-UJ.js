import{r as $,x as C,k as D,c as d,a,b as x,u as r,g as V,w as y,d as t,j as l,t as c,h as j,q as m,F as k,e as B,y as L,v,s as N,S as q,i as h,W as T}from"./app-OAsktpdo.js";import{_ as U}from"./AppLayout-CrSf5v8z.js";const z={class:"py-6"},E={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},F={key:0,class:"mb-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative"},A={key:1,class:"mb-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative"},H={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg p-6"},W=["disabled"],O=["value"],Y={key:0,class:"text-red-500 text-sm mt-1"},G={key:0,class:"text-red-500 text-sm mt-1"},I={class:"bg-gray-50 dark:bg-gray-900 p-4 rounded-lg"},J={class:"flex items-center mb-4"},K=["disabled"],P={key:0},Q=["min"],R={key:0,class:"text-red-500 text-sm mt-1"},X={key:0,class:"bg-yellow-50 dark:bg-yellow-900 p-4 rounded-lg text-yellow-800 dark:text-yellow-300"},Z={class:"flex items-center justify-between pt-4"},ee={class:"flex space-x-2"},te=["disabled"],se={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},ne={__name:"Edit",props:{post:Object,channels:Array},setup(i){const u=i,g=$(!!u.post.scheduled_at),s=C({channel_id:u.post.channel_id,content:u.post.content,scheduled_at:u.post.scheduled_at?f(new Date(u.post.scheduled_at)):f(new Date(Date.now()+36e5))}),w=D(()=>{const o=new Date;return o.setMinutes(o.getMinutes()+5),f(o)});function f(o){const e=o.getFullYear(),b=String(o.getMonth()+1).padStart(2,"0"),p=String(o.getDate()).padStart(2,"0"),n=String(o.getHours()).padStart(2,"0"),M=String(o.getMinutes()).padStart(2,"0");return`${e}-${b}-${p}T${n}:${M}`}function _(){({...s},g.value),s.put(route("posts.update",u.post.id))}function S(){confirm("Вы уверены, что хотите опубликовать этот пост сейчас?")&&s.put(route("posts.update",u.post.id),{onSuccess:()=>{T.post(route("posts.publish",u.post.id))}})}return(o,e)=>(a(),d(k,null,[x(r(V),{title:"Редактирование поста"}),x(U,null,{header:y(()=>e[4]||(e[4]=[t("div",{class:"flex justify-between items-center"},[t("h2",{class:"text-xl font-semibold text-gray-800 dark:text-gray-200 leading-tight"}," Редактирование поста ")],-1)])),default:y(()=>{var b,p;return[t("div",z,[t("div",E,[(b=o.$page.props.flash)!=null&&b.success?(a(),d("div",F,c(o.$page.props.flash.success),1)):l("",!0),(p=o.$page.props.flash)!=null&&p.error?(a(),d("div",A,c(o.$page.props.flash.error),1)):l("",!0),t("div",H,[t("form",{onSubmit:j(_,["prevent"]),class:"space-y-6"},[t("div",null,[e[5]||(e[5]=t("label",{for:"channel_id",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Канал",-1)),m(t("select",{id:"channel_id","onUpdate:modelValue":e[0]||(e[0]=n=>r(s).channel_id=n),class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:"",disabled:i.post.status==="pending"},[(a(!0),d(k,null,B(i.channels,n=>(a(),d("option",{key:n.id,value:n.id},c(n.name),9,O))),128))],8,W),[[L,r(s).channel_id]]),r(s).errors.channel_id?(a(),d("div",Y,c(r(s).errors.channel_id),1)):l("",!0)]),t("div",null,[e[6]||(e[6]=t("label",{for:"content",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Текст сообщения",-1)),m(t("textarea",{id:"content","onUpdate:modelValue":e[1]||(e[1]=n=>r(s).content=n),rows:"8",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"Введите текст вашего сообщения...",required:""},null,512),[[v,r(s).content]]),r(s).errors.content?(a(),d("div",G,c(r(s).errors.content),1)):l("",!0)]),t("div",I,[t("div",J,[m(t("input",{id:"schedule_enabled",type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=n=>g.value=n),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded",disabled:i.post.status==="pending"},null,8,K),[[N,g.value]]),e[7]||(e[7]=t("label",{for:"schedule_enabled",class:"ml-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Запланировать публикацию ",-1))]),g.value?(a(),d("div",P,[e[8]||(e[8]=t("label",{for:"scheduled_at",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Дата и время публикации",-1)),m(t("input",{id:"scheduled_at",type:"datetime-local","onUpdate:modelValue":e[3]||(e[3]=n=>r(s).scheduled_at=n),class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",min:w.value,required:""},null,8,Q),[[v,r(s).scheduled_at]]),r(s).errors.scheduled_at?(a(),d("div",R,c(r(s).errors.scheduled_at),1)):l("",!0)])):l("",!0)]),i.post.status==="pending"?(a(),d("div",X,e[9]||(e[9]=[t("div",{class:"flex items-center"},[t("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),t("p",null,"Пост находится в очереди на публикацию и не может быть полностью отредактирован. Вы можете изменить только содержимое поста.")],-1)]))):l("",!0),t("div",Z,[t("div",null,[x(r(q),{href:o.route("posts.show",i.post.id),class:"inline-flex items-center px-4 py-2 bg-gray-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-500 active:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition ease-in-out duration-150"},{default:y(()=>e[10]||(e[10]=[h(" Отмена ")])),_:1},8,["href"])]),t("div",ee,[t("button",{type:"submit",class:"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-500 active:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition ease-in-out duration-150",disabled:r(s).processing},[r(s).processing?(a(),d("svg",se,e[11]||(e[11]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):l("",!0),e[12]||(e[12]=h(" Сохранить "))],8,te),i.post.status!=="published"&&i.post.status!=="pending"?(a(),d("button",{key:0,type:"button",onClick:S,class:"inline-flex items-center px-4 py-2 bg-green-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-green-500 active:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition ease-in-out duration-150"},e[13]||(e[13]=[t("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),h(" Опубликовать ")]))):l("",!0)])])],32)])])])]}),_:1})],64))}};export{ne as default};
