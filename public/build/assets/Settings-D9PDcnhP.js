import{x as B,r as p,k as D,c as i,a as n,b as v,u as o,g as L,w as k,d as e,j as b,t as g,h as N,q as m,v as f,s as y,F as h,e as C,y as E,S as q,i as z}from"./app-OAsktpdo.js";import{_ as A}from"./AppLayout-CrSf5v8z.js";const F={class:"flex justify-between items-center"},G={class:"py-6"},O={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-6"},T={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},I={class:"p-6"},H={class:"mb-6"},J={class:"text-lg font-medium text-gray-900 dark:text-gray-100"},K={class:"mt-1 text-sm text-gray-600 dark:text-gray-400"},P={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Q={class:"mb-4"},R={key:0,class:"text-red-500 text-sm mt-1"},W={class:"mb-4"},X={key:0,class:"text-red-500 text-sm mt-1"},Y={class:"mb-4"},Z={class:"relative flex items-start mb-2"},ee={class:"flex items-center h-5"},te={class:"relative flex items-start mb-2"},re={class:"flex items-center h-5"},se={key:0,class:"mb-4"},oe={class:"mt-8 border-t border-gray-200 dark:border-gray-700 pt-6"},de={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ae={class:"relative flex items-start mb-4"},ie={class:"flex items-center h-5"},ne={key:0},le={class:"relative flex items-start mb-4"},ue={class:"flex items-center h-5"},ge={key:0},me={class:"mb-4"},ce={class:"mt-8 border-t border-gray-200 dark:border-gray-700 pt-6"},xe={key:0,class:"text-sm text-gray-500 dark:text-gray-400 italic mb-4"},be={key:1,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-6"},fe={class:"flex justify-between items-start"},ye={class:"font-medium text-gray-900 dark:text-gray-100"},pe={class:"text-sm text-gray-500 dark:text-gray-400"},ve=["onClick"],ke={class:"mb-4"},he={class:"mt-1 flex rounded-md shadow-sm"},we=["value"],_e=["disabled"],Ce={class:"flex justify-end mt-8"},je=["disabled"],Ve=["disabled"],Me={key:0,class:"fixed inset-0 z-10 overflow-y-auto"},Ue={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Se={class:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6"},$e={class:"mt-3 text-center sm:mt-5"},Be={class:"mt-2"},De={class:"text-sm text-gray-500 dark:text-gray-400"},Le={class:"mt-5 sm:mt-6 sm:grid sm:grid-cols-2 sm:gap-3 sm:grid-flow-row-dense"},ze={__name:"Settings",props:{group:{type:Object,required:!0},channels:{type:Array,default:()=>[]},allChannels:{type:Array,default:()=>[]},errors:{type:Object,default:()=>({})}},setup(l){var w,_;const d=l,s=B({name:d.group.name||"",description:d.group.description||"",moderation_enabled:d.group.moderation_enabled||!1,auto_approve:d.group.auto_approve||!1,auto_publish:d.group.auto_publish||!1,use_signature:!!d.group.signature,signature:d.group.signature||"",restricted_words:((_=(w=d.group.moderation_settings)==null?void 0:w.restricted_words)==null?void 0:_.join(", "))||""}),a=p(!1),c=p(""),x=p(!1),j=D(()=>{const u=d.channels.map(t=>t.id);return d.allChannels.filter(t=>!u.includes(t.id))}),V=()=>{a.value=!0;const u={...s.data(),restricted_words:s.restricted_words?s.restricted_words.split(",").map(t=>t.trim()):[]};s.put(route("groups.update",d.group.id),u,{onSuccess:()=>{a.value=!1},onError:()=>{a.value=!1}})},M=()=>{c.value&&(a.value=!0,axios.post(route("groups.channels.add",d.group.id),{channel_id:c.value}).then(()=>{c.value="",a.value=!1,window.location.reload()}).catch(()=>{a.value=!1}))},U=u=>{confirm("Вы уверены, что хотите удалить этот канал из группы?")&&(a.value=!0,axios.delete(route("groups.channels.remove",[d.group.id,u])).then(()=>{a.value=!1,window.location.reload()}).catch(()=>{a.value=!1}))},S=()=>{x.value=!0},$=()=>{a.value=!0,s.delete(route("groups.destroy",d.group.id),{onSuccess:()=>{a.value=!1,x.value=!1},onError:()=>{a.value=!1,x.value=!1}})};return(u,t)=>(n(),i(h,null,[v(o(L),{title:"Настройки группы"}),v(A,null,{header:k(()=>[e("div",F,[t[13]||(t[13]=e("h2",{class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"}," Настройки группы каналов ",-1)),v(o(q),{href:u.route("groups.index"),class:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm leading-4 font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},{default:k(()=>t[12]||(t[12]=[e("svg",{class:"mr-2 h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),z(" Назад к группам ")])),_:1},8,["href"])])]),default:k(()=>[e("div",G,[e("div",O,[e("div",T,[e("div",I,[e("div",H,[e("h3",J,g(l.group.name),1),e("p",K,g(l.group.description||"Описание не указано"),1)]),e("form",{onSubmit:N(V,["prevent"])},[e("div",P,[e("div",null,[e("div",Q,[t[14]||(t[14]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Название группы",-1)),m(e("input",{type:"text",name:"name",id:"name","onUpdate:modelValue":t[0]||(t[0]=r=>o(s).name=r),class:"mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300 rounded-md"},null,512),[[f,o(s).name]]),l.errors.name?(n(),i("div",R,g(l.errors.name),1)):b("",!0)]),e("div",W,[t[15]||(t[15]=e("label",{for:"description",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Описание",-1)),m(e("textarea",{name:"description",id:"description","onUpdate:modelValue":t[1]||(t[1]=r=>o(s).description=r),rows:"3",class:"mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300 rounded-md"},null,512),[[f,o(s).description]]),l.errors.description?(n(),i("div",X,g(l.errors.description),1)):b("",!0)])]),e("div",null,[e("div",Y,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Настройки публикации",-1)),e("div",Z,[e("div",ee,[m(e("input",{type:"checkbox",id:"auto_publish","onUpdate:modelValue":t[2]||(t[2]=r=>o(s).auto_publish=r),class:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 dark:border-gray-700 dark:bg-gray-800 rounded"},null,512),[[y,o(s).auto_publish]])]),t[16]||(t[16]=e("div",{class:"ml-3 text-sm"},[e("label",{for:"auto_publish",class:"font-medium text-gray-700 dark:text-gray-300"},"Автоматическая публикация"),e("p",{class:"text-gray-500 dark:text-gray-400"},"Публиковать посты автоматически во все каналы группы")],-1))]),e("div",te,[e("div",re,[m(e("input",{type:"checkbox",id:"use_signature","onUpdate:modelValue":t[3]||(t[3]=r=>o(s).use_signature=r),class:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 dark:border-gray-700 dark:bg-gray-800 rounded"},null,512),[[y,o(s).use_signature]])]),t[17]||(t[17]=e("div",{class:"ml-3 text-sm"},[e("label",{for:"use_signature",class:"font-medium text-gray-700 dark:text-gray-300"},"Использовать подпись"),e("p",{class:"text-gray-500 dark:text-gray-400"},"Добавлять подпись к каждому посту в группе")],-1))])]),o(s).use_signature?(n(),i("div",se,[t[19]||(t[19]=e("label",{for:"signature",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Подпись",-1)),m(e("textarea",{name:"signature",id:"signature","onUpdate:modelValue":t[4]||(t[4]=r=>o(s).signature=r),rows:"2",class:"mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300 rounded-md",placeholder:"Например: #новости #обновление"},null,512),[[f,o(s).signature]]),t[20]||(t[20]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"Поддерживается Markdown-форматирование",-1))])):b("",!0)])]),e("div",oe,[t[25]||(t[25]=e("h4",{class:"text-md font-medium text-gray-900 dark:text-gray-100 mb-4"},"Настройки модерации",-1)),e("div",de,[e("div",null,[e("div",ae,[e("div",ie,[m(e("input",{type:"checkbox",id:"moderation_enabled","onUpdate:modelValue":t[5]||(t[5]=r=>o(s).moderation_enabled=r),class:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 dark:border-gray-700 dark:bg-gray-800 rounded"},null,512),[[y,o(s).moderation_enabled]])]),t[21]||(t[21]=e("div",{class:"ml-3 text-sm"},[e("label",{for:"moderation_enabled",class:"font-medium text-gray-700 dark:text-gray-300"},"Включить модерацию"),e("p",{class:"text-gray-500 dark:text-gray-400"},"Посты будут проверяться перед публикацией")],-1))]),o(s).moderation_enabled?(n(),i("div",ne,[e("div",le,[e("div",ue,[m(e("input",{type:"checkbox",id:"auto_approve","onUpdate:modelValue":t[6]||(t[6]=r=>o(s).auto_approve=r),class:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 dark:border-gray-700 dark:bg-gray-800 rounded"},null,512),[[y,o(s).auto_approve]])]),t[22]||(t[22]=e("div",{class:"ml-3 text-sm"},[e("label",{for:"auto_approve",class:"font-medium text-gray-700 dark:text-gray-300"},"Автоутверждение"),e("p",{class:"text-gray-500 dark:text-gray-400"},"Автоматически утверждать посты, если они не содержат запрещенных слов")],-1))])])):b("",!0)]),o(s).moderation_enabled?(n(),i("div",ge,[e("div",me,[t[23]||(t[23]=e("label",{for:"restricted_words",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Запрещенные слова",-1)),m(e("textarea",{name:"restricted_words",id:"restricted_words","onUpdate:modelValue":t[7]||(t[7]=r=>o(s).restricted_words=r),rows:"3",class:"mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300 rounded-md",placeholder:"Введите запрещенные слова, разделяя их запятой"},null,512),[[f,o(s).restricted_words]]),t[24]||(t[24]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"Посты, содержащие эти слова, будут помечены для модерации",-1))])])):b("",!0)])]),e("div",ce,[t[29]||(t[29]=e("h4",{class:"text-md font-medium text-gray-900 dark:text-gray-100 mb-4"},"Каналы в группе",-1)),l.channels.length===0?(n(),i("div",xe," В этой группе еще нет каналов ")):(n(),i("div",be,[(n(!0),i(h,null,C(l.channels,r=>(n(),i("div",{key:r.id,class:"border border-gray-200 dark:border-gray-700 rounded-md p-3"},[e("div",fe,[e("div",null,[e("div",ye,g(r.name),1),e("div",pe,"@"+g(r.username),1)]),e("button",{type:"button",onClick:Ne=>U(r.id),class:"text-red-500 hover:text-red-700"},t[26]||(t[26]=[e("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,ve)])]))),128))])),e("div",ke,[t[28]||(t[28]=e("label",{for:"add_channel",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Добавить канал в группу",-1)),e("div",he,[m(e("select",{id:"add_channel","onUpdate:modelValue":t[8]||(t[8]=r=>c.value=r),class:"focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-none rounded-l-md sm:text-sm border-gray-300 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300"},[t[27]||(t[27]=e("option",{value:""},"Выберите канал",-1)),(n(!0),i(h,null,C(j.value,r=>(n(),i("option",{key:r.id,value:r.id},g(r.name)+" (@"+g(r.username)+") ",9,we))),128))],512),[[E,c.value]]),e("button",{type:"button",onClick:M,disabled:!c.value,class:"inline-flex items-center px-4 py-2 border border-transparent rounded-r-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50"}," Добавить ",8,_e)])])]),e("div",Ce,[e("button",{type:"button",onClick:t[9]||(t[9]=r=>u.$page.props.auth.user.id===l.group.user_id&&S()),class:"mr-3 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-red-700 dark:text-red-300 bg-red-100 dark:bg-red-900 hover:bg-red-200 dark:hover:bg-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",disabled:u.$page.props.auth.user.id!==l.group.user_id}," Удалить группу ",8,je),e("button",{type:"submit",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",disabled:a.value}," Сохранить изменения ",8,Ve)])],32)])])])]),x.value?(n(),i("div",Me,[e("div",Ue,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t[10]||(t[10]=r=>x.value=!1)}),e("div",Se,[e("div",null,[t[31]||(t[31]=e("div",{class:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900"},[e("svg",{class:"h-6 w-6 text-red-600 dark:text-red-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),e("div",$e,[t[30]||(t[30]=e("h3",{class:"text-lg leading-6 font-medium text-gray-900 dark:text-gray-100"}," Удалить группу ",-1)),e("div",Be,[e("p",De,' Вы уверены, что хотите удалить группу "'+g(l.group.name)+'"? Все связанные настройки будут удалены. Каналы не будут удалены, но они больше не будут связаны с этой группой. ',1)])])]),e("div",Le,[e("button",{type:"button",onClick:$,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:col-start-2 sm:text-sm"}," Удалить "),e("button",{type:"button",onClick:t[11]||(t[11]=r=>x.value=!1),class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 dark:border-gray-600 shadow-sm px-4 py-2 bg-white dark:bg-gray-800 text-base font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:col-start-1 sm:text-sm"}," Отмена ")])])])])):b("",!0)]),_:1})],64))}};export{ze as default};
